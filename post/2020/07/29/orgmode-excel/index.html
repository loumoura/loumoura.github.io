<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Tabelas em Org Mode e Excel - l moura</title>
    <meta property="og:title" content="Tabelas em Org Mode e Excel - l moura">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="Para o que Excel não consegue fazer, existe Org Mode">
      <meta property="og:description" content="Para o que Excel não consegue fazer, existe Org Mode">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      
<h1><a href="/"><img src="/author.png" alt="t" /></a></h1>


      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about_me/">Autor</a></li>
  
  <li><a href="/contact/">Contato</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Tabelas em Org Mode e Excel</h1>

<h3>Luis Moura
  /  2020-07-29</h3>
<hr>


      </header>






<p>A versão em <a href="/post/files/orgmode-excel.pdf">PDF</a> deste post, pode ser encontrada <a href="/post/files/orgmode-excel.pdf">aqui</a>.</p>
<div id="resumo" class="section level1">
<h1>Resumo</h1>
<p>Toda a gente que trabalha na elaboração de projetos de arquitetura e engenharia conhece o <a href="https://www.microsoft.com/en-us/microsoft-365/%20excel">Microsoft Excel</a>. Ele é um dos softwares preferidos dos engenheiros, pela sua fácil utilização, capacidade de partilha, e de grande customização. É fácil a introdução de formulas nas células, e os resultados são obtidos imediatamente. Um número enorme de ferramentas de apoio, tornam este software ainda mais apelativo.</p>
<p>No entanto o <code>Excel</code> tem limitações. As fórmulas não podem ter variáveis. É quase impossível descobrir o valor de uma incógnita <em>x</em>, calcular uma derivada ou primitiva. É aqui que entram as tabelas em <strong><a href="https://%20orgmode.org/">Org mode</a></strong>.</p>
<p>As tabelas em <a href="https://orgmode.org/">Org mode</a> e o Excel, são duas ferramentas distintas. O comum a ambos os softwares é que ambos produzem tabelas. Todo o resto é diferente. A escolha do software, depende do que se pretende fazer.</p>
<p>Só me vou concentrar nas funções básicas da tabela e do <a href="https://www.gnu.org/software/emacs/manual/html_mono/calc.html">Emacs Calculator</a>, que está incluído em qualquer versão do <a href="https://www.gnu.org/software/emacs/">GNU Emacs</a>. Mesmo assim, na sua versão mais simplista, as tabelas em <code>Org Mode</code> superam as funcionalidades do <code>Excel</code>, quando o objetivo é o cálculo estrutural ou outro cálculo associado ao trabalho de engenharia <sup><a id="fnr.1" class="footref"
href="#fn.1">1</a></sup></p>
<p><a id="orgb64f8ac"></a></p>
</div>
<div id="criar-uma-tabela-em-org-mode" class="section level1">
<h1>Criar uma Tabela em Org-Mode</h1>
<p>Org-Mode faz parte do editor Emacs. É um software com uma possibilidade quase infinita de funções. Por exemplo, este post foi escrito em <code>Org Mode</code>, sendo depois convertido em <code>HTML</code>.</p>
<p>Criar uma tabela em <code>Org-Mode</code> é simples, no entanto, não tão simples como em <code>Excel</code>. Em <code>Excel</code>, basta introduzir os dados nas células, e é fácil movimentar o cursor ao longo da folha. Em <code>Org-Mode</code> o mesmo já não é verdade pois a tabela é construída pelo utilizador.</p>
<p>Em <code>Org-Mode</code>, é necessário “escrever” a tabela. Um exemplo do formato para uma tabela, é aqui apresentado:</p>
<pre><code>| Coluna 1 | Coluna 2 | Coluna 3   |
|----------+----------+------------|
| Linha    |     1000 | A+B        |</code></pre>
<p>E o código em cima, dá origem a esta tabela:</p>
<table>
<thead>
<tr class="header">
<th>Coluna 1</th>
<th>Coluna 2</th>
<th>Coluna 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linha</td>
<td>1000</td>
<td>A+B</td>
</tr>
</tbody>
</table>
<p>Embora existam atalhos que facilitam e muito na criação da tabela, jamais se podem comparar à facilidade com que os dados são introduzidos em <code>Excel</code>. Assim, se o objetivo for a introdução de dados em uma folha, <code>Excel</code> é a ferramenta ideal para o trabalho.</p>
<p>O tempo de aprendizagem de <code>Org-Mode</code> é também bastante superior ao de <code>Excel</code>. Com um número quase infinito de novas possibilidades, a aprendizagem de Org-Mode é um processo lento e contínuo.</p>
<p><a id="org239f2c0"></a></p>
</div>
<div id="aonde-org-mode-supera-o-excel" class="section level1">
<h1>Aonde Org-Mode supera o Excel</h1>
<p>A lista do que é possível fazer com <code>Org Mode</code> é extensa e vai muito além dos objetivos deste post. O manual do <a href="https://orgmode.org/%20org.html#Tables">Tabelas em Org Mode</a> tem a lista dos atalhos que são possíveis utilizar assim como algumas das funcionalidades. No entanto, mesmo esta extensa lista, está muito aquém do que é possível fazer. Basta pensar que é possível utilizar <a href="https://www.python.org/">Python</a> nas tabelas em <code>Org Mode</code>, e é aberta uma nova janela de possibilidades. E <a href="https://www.python.org/">Python</a> é só uma das muitas linguagens informáticas possíveis de utilização.</p>
<p><code>Excel</code> tem a sua própria linguagem, <a href="https://docs.microsoft.com/en-us/%20office/vba/library-reference/concepts/getting-started-with-vba-in-office">VBA</a>. No entanto, esta fica muito aquém de <code>Python</code>. É possível conectar <code>Excel</code> com <code>Python</code> recorrendo a outros softwares, mas torna-se um sistema complicado e nada prático.</p>
<p><a id="org9dd873f"></a></p>
<div id="pros" class="section level2">
<h2>Prós</h2>
<ol style="list-style-type: decimal">
<li>É fácil o uso de outras linguagens informáticas, como LaTeX, Python, R, etc.</li>
<li>Org Mode é parte de Emacs, que já inclui uma calculadora bastante completa, equiparável às fórmulas em Excel.</li>
<li>É possível o uso e cálculo de incógnitas como em uma calculadora científica moderna.</li>
<li>As tabelas são formatadas para LaTeX, sendo os documentos em PDF produzidos, de uma qualidade muito superior a Excel.</li>
<li>Recorrendo a Python por exemplo, é possível o cálculo numérico.</li>
<li>Pode facilmente importar os dados de uma folha em Excel. Torna-se assim possível iniciar a recolha dos dados em Excel, e a sua posterior manipulação e análise, já em Org Mode.</li>
<li>Uma vez passada a fase inicial de aprendizagem e customização, tudo fica mais fácil, e torna-se um sistema bastante eficaz para a produção de documentos em PDF.</li>
<li>Org Mode foi criado para ser eficiente. Tal como em LaTeX, o objectivo é apresentar a informação de uma forma direta e clara.</li>
<li>Tal como tudo no universo Emacs, Org Mode é grátis</li>
</ol>
<p><a id="org1dd91c3"></a></p>
</div>
<div id="contras" class="section level2">
<h2>Contras</h2>
<ol style="list-style-type: decimal">
<li>O tempo inicial de aprendizagem da utilização de Org Mode em Emacs, é muito superior ao Excel</li>
<li>É necessário decorar as teclas de atalho para o uso eficiente do software.</li>
<li>O editor em si, não é tão visualmente apelativo como o Excel</li>
<li>Tudo pode ser customizado, mas requer muitas linhas de código, o que por sua vez, requer muito tempo de pesquisa na internet.</li>
<li>É necessário escrever o código para o formato da tabela.</li>
</ol>
<p><a id="org737b750"></a></p>
</div>
</div>
<div id="exemplos" class="section level1">
<h1>Exemplos</h1>
<p><a id="org3e575a9"></a></p>
<div id="armadura-de-flexao" class="section level2">
<h2>Armadura de Flexão</h2>
<p>Neste exemplo, é calculado a área de armadura necessária para um dado Momento. Os dados são introduzidos nas colunas 2-6, e os resultados são apresentados nas 3 últimas colunas.</p>
<pre><code>|   | med (kN) | fcd (mPa) | fyd (mPa) | b (m) | d(m) |      U |      W | As (cm2/m) |
|---+----------+-----------+-----------+-------+------+--------+--------+------------|
| # |      100 |      13.3 |       348 |     1 | 0.95 |        |        |            |
#+TBLFM: $7=$2/($5*$6**2*$3*10**3);%.4f::$8=1-sqrt(1-2*$7);%.4f::$9=$8*$5*$6*($3/$4)*10**4;%.2f</code></pre>
<table>
<thead>
<tr class="header">
<th>med (kN)</th>
<th>fcd (mPa)</th>
<th>fyd (mPa)</th>
<th>b (m)</th>
<th>d(m)</th>
<th>U</th>
<th>W</th>
<th>As (cm2/m)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>100</td>
<td>13.3</td>
<td>348</td>
<td>1</td>
<td>0.95</td>
<td>0.0083</td>
<td>0.0083</td>
<td>3.01</td>
</tr>
</tbody>
</table>
<p><strong>Uma breve explicação do código:</strong> Na primeira coluna, existe o simbolo “#”, que informa ao Emacs, para calcular imediatamente caso novos dados sejam introduzidos (como em Excel). Se não colocasse essa informação/opção, o cálculo só seria efectuado após ser invocado por teclas de atalho.</p>
<p>Por baixo da tabela, é aonde estão as fórmulas das 3 últimas colunas. O simbolo “$” antes de um número, indica o número da coluna ($7 = coluna 7).</p>
<p><a id="org29c6e09"></a></p>
</div>
<div id="soma-de-duas-funcoes" class="section level2">
<h2>Soma de duas funções</h2>
<p><span class="math display">\[f(x)+g(x)\]</span></p>
<p>A soma da função da coluna 2, com a função da coluna 3 (atenção que a coluna 1 é aonde está o “#” que informa o Emacs para executar automaticamente a soma e apresentar os resultados na coluna 4.</p>
<pre><code>|   | Função 1 | Função 2    | Resultado |
|---+----------+-------------+-----------|
| # | 2*x      | 3*x*cos(45) |           |
#+TBLFM: $4=$3+$2;n3</code></pre>
<p>De notar que a coluna 1 não aparece no formato HTML.</p>
<table>
<thead>
<tr class="header">
<th>Função 1</th>
<th>Função 2</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2*x</td>
<td>3*x*cos(45)</td>
<td>4.12 x</td>
</tr>
</tbody>
</table>
<p><a id="org8f16561"></a></p>
</div>
<div id="taylor" class="section level2">
<h2>Taylor</h2>
<p><span class="math display">\[f ( x ) = f ( a ) + \frac { f ^ { \prime } ( a ) } { 1 ! } ( x - a ) + \frac { f ^ { ( 2 ) } ( a ) } { 2 ! } ( x - a ) ^ { 2 } + \cdots + \frac { f ^ { ( n ) } ( a ) } { n ! } ( x - a ) ^ { n } + R\]</span></p>
<pre><code>| função      | n | x   | Resultado   |
|-------------+---+-----+-------------|
| x^2+sqrt(x) | 1 | x=0 |             |
| x^2+sqrt(x) | 0 | x=1 |             |
#+TBLFM: $4=taylor($1,$3,$2);n3</code></pre>
<table>
<thead>
<tr class="header">
<th>função</th>
<th>n</th>
<th>x</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x<sup>2</sup>+sqrt(x)</td>
<td>1</td>
<td>x=0</td>
<td>x*(0.5 / 0)</td>
</tr>
<tr class="even">
<td>x<sup>2</sup>+sqrt(x)</td>
<td>0</td>
<td>x=1</td>
<td>2</td>
</tr>
</tbody>
</table>
<p><a id="orgcf10679"></a></p>
</div>
<div id="solve" class="section level2">
<h2>Solve</h2>
<p>Calcula o valor de uma incógnita em uma função.</p>
<pre><code>|   | função esquerda | função direita | Resultado               |
|---+-----------------+----------------+-------------------------|
| # | x*2             |              1 |                         |
| # | cos(x)          |              0 |                         |
| # | 25+x*2          |            x-5 |                         |
#+TBLfm: $4=fsolve($2=$3,x);n3</code></pre>
<table>
<thead>
<tr class="header">
<th>função esquerda</th>
<th>função direita</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x*2</td>
<td>1</td>
<td>x = 0.5</td>
</tr>
<tr class="even">
<td>cos(x)</td>
<td>0</td>
<td>x = 90 s1 + 360 n1</td>
</tr>
<tr class="odd">
<td>25+x*2</td>
<td>x-5</td>
<td>x = -30</td>
</tr>
</tbody>
</table>
<p><a id="org90ce4d3"></a></p>
</div>
<div id="derivada" class="section level2">
<h2>Derivada</h2>
<p>Calcula a derivada de uma função</p>
<pre><code>|   | função   | Resultado       |
|---+----------+-----------------|
| # | x        |                 |
| # | sin(x)   |                 |
| # | x**2+2*x |                 |
 #+TBLfm: $3=deriv($2,x)</code></pre>
<table>
<thead>
<tr class="header">
<th>função</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>1</td>
</tr>
<tr class="even">
<td>sin(x)</td>
<td>cos(x) pi / 180</td>
</tr>
<tr class="odd">
<td>x**2+2*x</td>
<td>2 x + 2</td>
</tr>
</tbody>
</table>
<p><a id="org082111d"></a></p>
</div>
<div id="integral" class="section level2">
<h2>Integral</h2>
<p>Também é possível fazer a integração de uma função</p>
<pre><code>|   | função | Resultado   |
|---+--------+-------------|
| # | x      |             |
| # | ln(x)  |             |
#+TBLFM: $3=integ($2,x)</code></pre>
<table>
<thead>
<tr class="header">
<th>função</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>x<sup>2</sup> / 2</td>
</tr>
<tr class="even">
<td>ln(x)</td>
<td>x ln(x) - x</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="ficheiro-org-mode" class="section level1">
<h1>Ficheiro Org Mode</h1>
<p>Uma cópia do ficheiro usado na criação deste post, pode ser visto em baixo. O ficheiro foi criado no editor Emacs. Fazer o click em <strong>view raw</strong>, no canto inferior direito da janela, para ver o código sem estar formatado.</p>
<script src="https://gist.github.com/loumoura/8a403789ebbb81f28fa45fa3edb6031b.js"></script>
<p><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> Para a introdução de dados, sua manipulação e visualização e se a lista de dados for extensa, é melhor a utilização de Excel</p>
</div>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/post/2020/07/25/martelo/">Tributo : Ferramentas do meu passado</a></span>
  <span class="nav-next"></span>
</nav>





<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/python.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="/">Luis Moura</a> 20016 - 2021</div>
  
  </footer>
  </article>
  
  </body>
</html>

